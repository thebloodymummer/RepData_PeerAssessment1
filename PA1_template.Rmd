---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

This Assignment provides a detailed HTML formatted file produced using R Markdown. The data is collected from personal activity monitering device such as Fitbit *etc*. from an anaymous person.The data is collected at 5 minute intervals from the period between October and November 2012.  

The three variables are:  
- Steps: The number of steps taken in the 5 minute intervals.  
- Date: The particlur date the measurements were taken (YYYY-MM-DD).  
- interval: The 5 minute interval (in minutes)  
- Missing values are represented by NA  

The data is stores as a CSV file and there are 17,568 observations per column.  

## Loading and preprocessing the data

Initially the data is downloaded as a zip file and put in the working directory. The data is then unzipped and the activity.csv file containing the data is read.

```{r, echo = TRUE, results = "hide"}
if(!file.exists("Assignemnt")){dir.create("Assignment")}
fileUrl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
destFile <- "./Assignment/activity.zip"
download.file(fileUrl, 
              destFile)
unzip(destFile, exdir = "./Assignment")
activityData <- read.csv("./Assignment/activity.csv", 
                         header = TRUE, 
                         sep = ",")
```

Finally, the date is transformed into the class of "Date"

```{r, echo = TRUE}
class(activityData$date)
```

```{r, echo = TRUE}
activityData$date <- as.Date(activityData$date, 
                             format="%Y-%m-%d")
class(activityData$date)
```

## What is mean total number of steps taken per day?
### Total number of steps taken each day.

Initially, the total number of steps taken each day is calculated.

```{r, echo = TRUE}
totalNumber <- as.data.frame(lapply(split(activityData$steps, 
                                          activityData$date), 
                                    sum))
totalNumber <- t(totalNumber)
totalNumber2 <-data.frame(unique(activityData$date), 
                          totalNumber)
rownames(totalNumber2) <- c()
colnames(totalNumber2) <- c("Date", "Total Number")
totalNumber2[complete.cases(totalNumber2), ]
```

I think some of the days the gadget must have been switched off ;)

### Histagram of the total number of steps taken each day

```{r, echo = TRUE}
hist(totalNumber2$`Total Number`, 
     breaks = 10, 
     col = "green", 
     main = "Total Number of Steps Taken Each Day", 
     xlab = "Total Number of Steps")
```

### The Mean and Median number of steps taken each day.

The mean and median number of steps taken each day are as follows.

```{r, echo = TRUE}
Mean <- mean(totalNumber, 
             na.rm = TRUE)
Median <- median(totalNumber, 
                 na.rm = TRUE)
cat("The mean is", Mean, "and the median is", Median)
```

## What is the average daily activity pattern?

The average number of steps per 5 minute interval over the 2 months was taken. 

```{r, echo = TRUE}
activityData2 <- activityData[complete.cases(activityData$steps),]
mean1 <- aggregate(steps ~ interval, 
                   activityData2, 
                   mean)
plot(mean1$interval, 
     mean1$steps, 
     type = "l", 
     main = "Average Number of Steps", 
     xlab = "Interval (minutes)",
     ylab = "Average Number of Steps",
     col = "green")
```

The 5 minute Interval containing the highest average number of steps was calculated bu the following.

```{r}
mean1[which.max(mean1$steps),]
```

## Imputing missing values

Before processing, the % of missing values was determined.

````{r, echo = TRUE}
mean(is.na(activityData))
````

This is a relatively small amount however these NA values were removed.

```{r}

activityData <- activityData[complete.cases(activityData), ]

````


## Are there differences in activity patterns between weekdays and weekends?
